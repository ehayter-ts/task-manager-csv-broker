!function(){function e(e){return e.split("<content>")[1].split("</content>")[0]}metadata={systemName:"TaskManagerCSVReader",displayName:"Task Manager CSV Reader Broker",description:"A broker that reads a CSV file and returns the info for use in the Task Manager Application.",configuration:{FirstRowIsHeader:{displayName:"First Row Is Header",type:"boolean",value:!0},LineSplitChar:{displayName:"Line Split Character",type:"string",value:"newline"},FieldSplitChar:{displayName:"Field Split Character",type:"string",value:";"}}},ondescribe=async function({configuration:e}){postSchema({objects:{tasks:{displayName:"Tasks",description:"Describes all tasks in a CSV file",properties:{fileContent:{displayName:"File Content",type:"string"},id:{displayName:"ID",type:"number"},reference:{displayName:"Internal Reference",type:"string"},category:{displayName:"Category",type:"string"},priority:{displayName:"Priority",type:"string"},assignedTo:{displayName:"Assigned To",type:"string"},subject:{displayName:"Subject",type:"string"},description:{displayName:"Description",type:"string"},dueDate:{displayName:"Task Due Date",type:"dateTime"}},methods:{getTasks:{displayName:"Get Tasks",type:"list",inputs:["fileContent"],outputs:["id","reference","category","priority","assignedTo","subject","description","dueDate"]},getTask:{displayName:"Get Task",type:"read",inputs:["fileContent","id"],outputs:["id","reference","category","priority","assignedTo","subject","description","dueDate"]}}}}})},onexecute=async function({objectName:r,methodName:i,parameters:a,properties:n,configuration:o,schema:s}){switch(r){case"tasks":await async function(r,i,a){switch(r){case"getTasks":await function(r,i){return new Promise((a,n)=>{try{const n=t.decode(e(r.fileContent.toString()));var o=[];o="newline"==i.LineSplitChar.toString()?n.split(/\r?\n/):n.split(i.LineSplitChar.toString());var s=[];for(let e=i.FirstRowIsHeader?1:0;e<o.length;e++){var d=o[e].split(i.FieldSplitChar.toString());s.push({id:e,reference:d[0],category:d[1],priority:d[2],assignedTo:d[3],subject:d[4],description:d[5],dueDate:d[6]})}postResult(s.map(e=>({id:e.id,reference:e.reference,category:e.category,priority:e.priority,assignedTo:e.assignedTo,subject:e.subject,description:e.description,dueDate:Date.parse(e.dueDate)}))),a()}catch(e){n(e)}})}(i,a);break;case"getTask":await function(r,i){return new Promise((a,n)=>{try{const n=t.decode(e(r.fileContent.toString()));var o=[];o="newline"==i.LineSplitChar.toString()?n.split(/\r?\n/):n.split(i.LineSplitChar.toString());var s=parseInt(r.id.toString()),d=o[s].split(i.FieldSplitChar.toString()),c={id:s,reference:d[0],category:d[1],priority:d[2],assignedTo:d[3],subject:d[4],description:d[5],dueDate:d[6]};postResult({reference:c.reference,category:c.category,priority:c.priority,assignedTo:c.assignedTo,subject:c.subject,description:c.description,dueDate:Date.parse(c.dueDate)}),a()}catch(e){n(e)}})}(i,a);break;default:throw new Error("The method "+r+" is not supported.")}}(i,n,o);break;default:throw new Error("The object "+r+" is not supported.")}};var t={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var r,i,a,n,o,s,d,c="",p=0;for(e=t._utf8_encode(e);p<e.length;)n=(r=e.charCodeAt(p++))>>2,o=(3&r)<<4|(i=e.charCodeAt(p++))>>4,s=(15&i)<<2|(a=e.charCodeAt(p++))>>6,d=63&a,isNaN(i)?s=d=64:isNaN(a)&&(d=64),c=c+this._keyStr.charAt(n)+this._keyStr.charAt(o)+this._keyStr.charAt(s)+this._keyStr.charAt(d);return c},decode:function(e){var r,i,a,n,o,s,d="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)r=this._keyStr.indexOf(e.charAt(c++))<<2|(n=this._keyStr.indexOf(e.charAt(c++)))>>4,i=(15&n)<<4|(o=this._keyStr.indexOf(e.charAt(c++)))>>2,a=(3&o)<<6|(s=this._keyStr.indexOf(e.charAt(c++))),d+=String.fromCharCode(r),64!=o&&(d+=String.fromCharCode(i)),64!=s&&(d+=String.fromCharCode(a));return d=t._utf8_decode(d)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t+=String.fromCharCode(i):i>127&&i<2048?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t},_utf8_decode:function(e){for(var t="",r=0,i=0,a=0,n=0;r<e.length;)(i=e.charCodeAt(r))<128?(t+=String.fromCharCode(i),r++):i>191&&i<224?(a=e.charCodeAt(r+1),t+=String.fromCharCode((31&i)<<6|63&a),r+=2):(a=e.charCodeAt(r+1),n=e.charCodeAt(r+2),t+=String.fromCharCode((15&i)<<12|(63&a)<<6|63&n),r+=3);return t}}}();
//# sourceMappingURL=index.js.map
